<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>نظام إدارة المخزون</title>
  <style>
    body { font-family: 'Cairo', Arial, sans-serif; background: #f2f5f7; margin: 0; } 
    header { background: #007bff; color: #fff; padding: 1.2em 0; text-align: center; font-size: 1.7em; letter-spacing: 1px; }
    section { box-shadow: 0 2px 6px #e6e6e6; }
    input, select, button {
      font-family: inherit;
      font-size: 1em;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      outline: none;
      background: #fff;
      transition: border .2s;
    }
    input:focus, select:focus { border: 1px solid #007bff; }
    button { cursor: pointer; }
    th, td { padding: 10px 6px; text-align: center; }
    th { color: #007bff; }
    tr:nth-child(even) { background:#fafbfc; }
    .edit-btn { background:#ffc107;color:#222;border:none;border-radius:5px;padding:5px 10px; }
    @media(max-width:650px) {
      form[id=shipmentForm] input, form[id=shipmentForm] select, form[id=shipmentForm] button, form[id=shipmentForm] label { flex:100%; margin-bottom:8px; }
      section { padding:1em; }
      th, td {font-size:15px;}
    }
  </style>
</head>
<body>
  <header>نظام إدارة المخزون</header>

  <!-- قسم تتبع بوليصات الشحن -->
  <section style="direction: rtl; margin: 2em 0; background: #f8f9fa; border-radius: 10px; padding: 2em;">
    <h2 style="color: #007bff; margin-bottom: 1em;">تتبع بوليصات الشحن</h2>
    <form id="shipmentForm" style="display:flex; flex-wrap: wrap; gap:10px;">
      <input type="text" id="orderId" placeholder="رقم الطلب" required style="flex:1;">
      <input type="text" id="shipmentNumber" placeholder="رقم بوليصة الشحن" required style="flex:1;">
      <select id="trackingStatus" style="flex:1;">
        <option value="تم التحضير">تم التحضير</option>
        <option value="بالمستودع">بالمستودع</option>
        <option value="في الطريق">في الطريق</option>
        <option value="تم الاستلام">تم الاستلام</option>
      </select>
      <label style="display: flex; align-items: center; flex:1;">
        <input type="checkbox" id="delivered" style="margin-left:5px;"> تم الاستلام
      </label>
      <button type="submit" style="flex:1; background:#007bff; color:#fff; border:none; border-radius:5px; padding:8px;">إضافة الشحنة</button>
    </form>
    <hr>
    <div style="overflow-x:auto;">
      <table id="shipmentsTable" style="width:100%; border-collapse: collapse; margin-top:1em;">
        <thead style="background:#eee;">
          <tr>
            <th>رقم الطلب</th>
            <th>رقم بوليصة الشحن</th>
            <th>حالة التتبع</th>
            <th>تم الاستلام</th>
            <th>آخر تحديث</th>
            <th>تعديل</th>
          </tr>
        </thead>
        <tbody>
          <!-- ستظهر البيانات ديناميكياً -->
        </tbody>
      </table>
    </div>
  </section>

  <!-- باقي محتوى الصفحة يمكن إضافته هنا -->

  <script>
    // ====== إدارة بوليصات الشحن ======
    function loadShipments() {
      return JSON.parse(localStorage.getItem('shipments') || "[]");
    }
    function saveShipments(arr) {
      localStorage.setItem('shipments', JSON.stringify(arr));
    }
    function renderShipmentsTable() {
      let shipments = loadShipments();
      let tbody = document.querySelector('#shipmentsTable tbody');
      tbody.innerHTML = '';
      shipments.forEach((s, idx) => {
        tbody.innerHTML += `
          <tr>
            <td>${s.orderId}</td>
            <td>${s.shipmentNumber}</td>
            <td>${s.trackingStatus}</td>
            <td>${s.delivered ? "✅" : "❌"}</td>
            <td>${new Date(s.lastUpdate).toLocaleString()}</td>
            <td>
              <button onclick="editShipment(${idx})" class="edit-btn">تعديل</button>
            </td>
          </tr>
        `;
      });
    }

    // حفظ النموذج الأساسي
    function defaultShipmentFormSubmit(e) {
      e.preventDefault();
      let shipment = {
        orderId: document.getElementById('orderId').value,
        shipmentNumber: document.getElementById('shipmentNumber').value,
        trackingStatus: document.getElementById('trackingStatus').value,
        delivered: document.getElementById('delivered').checked,
        lastUpdate: new Date().toISOString()
      };
      let shipments = loadShipments();
      shipments.push(shipment);
      saveShipments(shipments);
      renderShipmentsTable();
      this.reset();
      document.getElementById('shipmentForm').onsubmit = defaultShipmentFormSubmit;
    }
    document.getElementById('shipmentForm').onsubmit = defaultShipmentFormSubmit;

    // خاصية التعديل:
    window.editShipment = function(idx) {
      let shipments = loadShipments();
      let s = shipments[idx];
      // جلب القيم في النموذج للتعديل
      document.getElementById('orderId').value = s.orderId;
      document.getElementById('shipmentNumber').value = s.shipmentNumber;
      document.getElementById('trackingStatus').value = s.trackingStatus;
      document.getElementById('delivered').checked = s.delivered;
      // عند حفظ النموذج بعد التعديل
      document.getElementById('shipmentForm').onsubmit = function(e) {
        e.preventDefault();
        s.orderId = document.getElementById('orderId').value;
        s.shipmentNumber = document.getElementById('shipmentNumber').value;
        s.trackingStatus = document.getElementById('trackingStatus').value;
        s.delivered = document.getElementById('delivered').checked;
        s.lastUpdate = new Date().toISOString();
        shipments[idx] = s;
        saveShipments(shipments);
        renderShipmentsTable();
        this.reset();
        // إعادة الفورم للوضع الطبيعي
        document.getElementById('shipmentForm').onsubmit = defaultShipmentFormSubmit;
      };
    };

    // عند فتح الصفحة أول مرة
    window.onload = renderShipmentsTable;
  </script>

</body>
</html>
